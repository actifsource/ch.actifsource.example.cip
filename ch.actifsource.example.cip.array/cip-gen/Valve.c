/*******************************************************************
        SYSTEM ChairArray
        Module for PROCESS Valve
        Filename: Valve.c
        generated by CIP Tool(R)

        activated code options:
        	C code
        	use channel interface
        		naming option: use default prefix
        	'unsigned long' for delays
*********************************************************************/

/* Include Files */

#include "mChairUnit.h"

/* Process Macro Definitions */

#define ID (*id_)
#define SELF (*self_)
#define STATUS (pStatus_Valve->read_access_)
#define TIME time_

/* Process Enumerations */

enum eMODES_Valve
	{normal = 1};

enum eSTATES_Valve
	{closing = 1, opening};

enum eINPULS_Valve
	{IP_close = 1, IP_open};
	

/* External Declarations */

extern unsigned long time_;
extern struct tCHNOUT_mChairUnit CHNOUT_mChairUnit;

/* Global Declarations */

union tSTATUS_Valve status_Valve;
const union tSTATUS_Valve *pStatus_Valve = &status_Valve;
static struct tPRSTAT_Valve *self_;
static struct tID_Valve currentid_;
static const struct tID_Valve *id_ = &currentid_;

/* Function Prototypes */

int fPULSE_Valve (enum eOUTPLS_ name_,
   struct tID_Valve *procid_);
void fINIT_Valve (void);

/* Input Channel Functions */

int fPULSE_Valve (enum eOUTPLS_ name_,
   struct tID_Valve *procid_)
{
	currentid_ = *procid_;
	self_ = &status_Valve.write_access_[currentid_.cushionIndex];
	switch(name_)
	{
		/* INPULSE close */
	case O9_stop:		/* PULSE CAST from PROCESS Proxy */
		switch(status_Valve.read_access_[currentid_.cushionIndex].STATE)
		{
		case opening:
			status_Valve.write_access_[currentid_.cushionIndex].STATE = closing;
			CHNOUT_mChairUnit.message_.CHAN_Act_Valve.name_ = C5_close;
			CHNOUT_mChairUnit.message_.CHAN_Act_Valve.id_.cushionIndex = currentid_.cushionIndex;
			OUT_.Act_Valve(CHNOUT_mChairUnit.message_.CHAN_Act_Valve.name_,
			   &CHNOUT_mChairUnit.message_.CHAN_Act_Valve.id_);
			break;
		default:
			break;
		}
		break;
		/* INPULSE open */
	case O9_evac:		/* PULSE CAST from PROCESS Proxy */
	case O9_fill:		
		switch(status_Valve.read_access_[currentid_.cushionIndex].STATE)
		{
		case closing:
			status_Valve.write_access_[currentid_.cushionIndex].STATE = opening;
			CHNOUT_mChairUnit.message_.CHAN_Act_Valve.name_ = C5_open;
			CHNOUT_mChairUnit.message_.CHAN_Act_Valve.id_.cushionIndex = currentid_.cushionIndex;
			OUT_.Act_Valve(CHNOUT_mChairUnit.message_.CHAN_Act_Valve.name_,
			   &CHNOUT_mChairUnit.message_.CHAN_Act_Valve.id_);
			break;
		default:
			break;
		}
		break;
	default:
		return 0;
	}
	return 1;
}

/* Process Initialization Function */

void fINIT_Valve (void)
{
	int LOCAL_cushionIndex;
	for (LOCAL_cushionIndex = 0; LOCAL_cushionIndex < CUSHION_COUNT; LOCAL_cushionIndex++)
	{
		status_Valve.write_access_[LOCAL_cushionIndex].STATE = closing;
	}
}		

/*********************************************************************
	End of Module for PROCESS Valve
*********************************************************************/
/* Actifsource ID=[e9267837-2596-11e1-ae2f-a14f3e396de6,2e7be38b-c77a-11ea-9e9f-c1d3048691bc,2e797237-c77a-11ea-9e9f-c1d3048691bc,2e7be3c2-c77a-11ea-9e9f-c1d3048691bc,2e7be389-c77a-11ea-9e9f-c1d3048691bc,2e7be388-c77a-11ea-9e9f-c1d3048691bc,2e7973fe-c77a-11ea-9e9f-c1d3048691bc,ZR2G/GWoOtLx4cfejHhY2Bvdm5Q=] */
